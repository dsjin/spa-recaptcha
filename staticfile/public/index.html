<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Recaptcha Form Sender</title>
  <style>
    .header {
      text-align: center;
    }
    .submitContainer {
      text-align: center;
    }
    #resposneBlock {
      width: 960px;
      margin: 0 auto 30px;
      padding: 2em;
      border-radius: 50px;
      border: solid 2px #6c9bd2;
      overflow-x: scroll;
    }
    .sendButton {
      outline: none !important;
      border: none;
      border-radius: 0;
      -webkit-appearance: none;
      padding: 20px 0;
      margin: 0 18px;
      font-size: 1rem;
      color: #fff;
      letter-spacing: 2px;
      text-align: center;
      background: #6c9bd2;
      cursor: pointer;
      display: inline-block;
      width: 418px;
      -webkit-box-sizing: border-box;
      -moz-box-sizing: border-box;
      -ms-box-sizing: border-box;
      -o-box-sizing: border-box;
      box-sizing: border-box;
    }
    /*TABLES*/

    /*table01*/

    table.table01{
      width: 960px;
      margin: 0 auto 30px;
      color: #000;
      font-size: 0.875rem;
      line-height: 190%;
      border-top: 1px solid #dde6f1;
      /*border-bottom: 1px solid #dde6f1;*/
    }

    table.table01 th{
      margin: 0;
      padding: 17px 20px;

      line-height: 160%;

      border-bottom: 1px solid #fff;

      box-sizing: border-box;
      -webkit-box-sizing: border-box;
      -moz-box-sizing: border-box;
      -ms-box-sizing: border-box;

      width: 30%;
      color: #000;
      text-align: left;
      vertical-align: top;
      background: #dde6f1;
      border-left: none;
    }

    table.table01 td{
      margin: 0;
      padding: 17px 20px;

      line-height: 160%;

      border-bottom: 1px solid #dde6f1;

      box-sizing: border-box;
      -webkit-box-sizing: border-box;
      -moz-box-sizing: border-box;
      -ms-box-sizing: border-box;
    }

    table.table01 td dl{
      margin-bottom: 20px;
    }

    table.table01 td dl:last-child{
      margin-bottom: 0;
    }
  </style>
</head>

<body>
  <h1 class="header">
    Recaptcha Form Sender
  </h1>
  <table id="form1_input_table" class="the_form normal table01" border="0" cellspacing="0" cellpadding="0"
    style="display: table;">
    <tbody>
      <tr>
        <th>お問合せ内容<span class="hissu">※</span></th>
        <td>
          <div id="types"><input type="radio" name="type" id="type__0" value="JPNEについて"><label for="type__0">
              JPNEについて</label><br class="sp_mode"><input type="radio" name="type" id="type__1" value="サービスについて"><label
              for="type__1"> サービスについて</label><br class="sp_mode"><input type="radio" name="type" id="type__2"
              value="その他"><label for="type__2"> その他</label><br class="sp_mode"></div>
          <span id="input_type"></span>
        </td>
      </tr>
      <tr>
        <th>件名<span class="hissu">※</span></th>
        <td><input name="topic" type="text" class="middle" id="topic" value="">
          <input type="hidden" name="topic_flg" id="topic_flg" value=""> <span id="input_topic"></span>

        </td>
      </tr>
      <tr>
        <th>会社名<span class="hissu">※</span></th>
        <td><input name="name1" type="text" class="middle" id="name1" value="">
          <input type="hidden" name="name1_flg" id="name1_flg" value=""> <span id="input_name1"></span>
        </td>
      </tr>
      <tr>
        <th>担当部署<span class="hissu">※</span></th>
        <td><input name="name2" type="text" class="middle" id="name2" value="">
          <input type="hidden" name="name2_flg" id="name2_flg" value=""> <span id="input_name2"></span>
        </td>
      </tr>
      <tr>
        <th>ご担当者名<span class="hissu">※</span></th>
        <td><input name="name3" type="text" class="middle" id="name3" value="">
          <input type="hidden" name="name3_flg" id="name3_flg" value=""> <span id="input_name3"></span>
        </td>
      </tr>
      <tr>
        <th>ご担当者名(ふりがな)<span class="hissu">※</span></th>
        <td><input name="name4" type="text" class="middle" id="name4" value="">
          <input type="hidden" name="name4_flg" id="name4_flg" value=""> <span id="input_name4"></span>
        </td>
      </tr>
      <tr>
        <th>住所<span class="hissu">※</span></th>
        <td>〒 <span id="input_zip"></span><input name="zip" type="text" class="small addNum" id="zip" value="">
          <input type="hidden" name="zip_flg" id="zip_flg" value=""><br>
          <select name="ken" id="ken">
            <option value="--都道府県--">--都道府県--</option>
            <option value="北海道">北海道</option>
            <option value="青森県">青森県</option>
            <option value="岩手県">岩手県</option>
            <option value="宮城県">宮城県</option>
            <option value="秋田県">秋田県</option>
            <option value="山形県">山形県</option>
            <option value="福島県">福島県</option>
            <option value="茨城県">茨城県</option>
            <option value="栃木県">栃木県</option>
            <option value="群馬県">群馬県</option>
            <option value="埼玉県">埼玉県</option>
            <option value="千葉県">千葉県</option>
            <option value="東京都">東京都</option>
            <option value="神奈川県">神奈川県</option>
            <option value="新潟県">新潟県</option>
            <option value="富山県">富山県</option>
            <option value="石川県">石川県</option>
            <option value="福井県">福井県</option>
            <option value="山梨県">山梨県</option>
            <option value="長野県">長野県</option>
            <option value="岐阜県">岐阜県</option>
            <option value="静岡県">静岡県</option>
            <option value="愛知県">愛知県</option>
            <option value="三重県">三重県</option>
            <option value="滋賀県">滋賀県</option>
            <option value="京都府">京都府</option>
            <option value="大阪府">大阪府</option>
            <option value="兵庫県">兵庫県</option>
            <option value="奈良県">奈良県</option>
            <option value="和歌山県">和歌山県</option>
            <option value="鳥取県">鳥取県</option>
            <option value="島根県">島根県</option>
            <option value="岡山県">岡山県</option>
            <option value="広島県">広島県</option>
            <option value="山口県">山口県</option>
            <option value="徳島県">徳島県</option>
            <option value="香川県">香川県</option>
            <option value="愛媛県">愛媛県</option>
            <option value="高知県">高知県</option>
            <option value="福岡県">福岡県</option>
            <option value="佐賀県">佐賀県</option>
            <option value="長崎県">長崎県</option>
            <option value="熊本県">熊本県</option>
            <option value="大分県">大分県</option>
            <option value="宮崎県">宮崎県</option>
            <option value="鹿児島県">鹿児島県</option>
            <option value="沖縄県">沖縄県</option>
          </select> <span id="input_ken"></span>
          <input name="address" type="text" class="max" id="address" value="">
          <input type="hidden" name="address_flg" id="address_flg" value=""> <span id="input_address"></span>

        </td>
      </tr>
      <tr>
        <th>TEL<span class="hissu">※</span></th>
        <td><input name="tel" type="text" class="middle" id="tel" value="">
          <input type="hidden" name="tel_flg" id="tel_flg" value=""> <span id="input_tel"></span>
        </td>
      </tr>
      <tr>
        <th>FAX</th>
        <td><input name="fax" type="text" class="middle" id="fax" value="">
          <input type="hidden" name="fax_flg" id="fax_flg" value=""> <span id="input_fax"></span>
        </td>
      </tr>
      <tr>
        <th>Eメールアドレス<span class="hissu">※</span></th>
        <td><input name="mailaddress" type="text" class="middle" id="mailaddress" value="">
          <input type="hidden" name="mailaddress_flg" id="mailaddress_flg" value=""> <span
            id="input_mailaddress"></span>
        </td>
      </tr>
      <tr>
        <th>ご要望・お問合せ内容<br>をできるだけ詳細に<br>ご記入ください。<span class="hissu">※</span></th>
        <td><input type="hidden" name="comment_flg" id="comment_flg" value="0"><textarea name="comment" class=""
            id="comment"></textarea>
          <span id="input_comment"></span>
        </td>
      </tr>
    </tbody>
  </table>
  <div
    id="resposneBlock"
    style="display:none"
  >
  </div>
  <div class="submitContainer">
    <button
      id="sendButton"
      class="sendButton"
    >
      Submit
    </button>
  </div>
  <div id="gRecaptcha"></div>
  <!-- <script src="https://ajaxzip3.github.io/ajaxzip3.js" charset="UTF-8"></script> -->
  <script src="https://www.google.com/recaptcha/api.js?onload=recaptchaInitCallback&render=explicit" async defer></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
  <!-- <script defer src="https://www.jpne.cloud-partner.site/wp-content/themes/jpne/js/jquery-form-reporter-min.js"></script> -->
  <script>
    const config = {
      siteKey: 'Your Site Key',
      endpoint: 'https://nyhtl2wyo4.execute-api.ap-northeast-1.amazonaws.com/dev/contractus'
    }
    class Captcha {
      instance = null
      constructor (el, siteKey, verifyCallback, expireCallback, failCallback) {
        this.instance = window.grecaptcha.render(
          el,
          {
            sitekey: siteKey,
            callback: (response) => verifyCallback ? verifyCallback(response) : this.verify(response),
            'expired-callback': () => expireCallback ? expireCallback() : this.expire(),
            'error-callback': () => failCallback ? failCallback() : this.fail(),
            size: 'invisible'
          }
        )
      }
      expire () {
        console.log('Expired')
      }
      fail () {
        console.log('Failed')
      }
      verify (resposne) {
        console.log(resposne)
      }
      reset () {
        window.grecaptcha.reset(this.instance)
      }
      execute () {
        window.grecaptcha.execute(this.instance)
      }
      getToken () {
        return window.grecaptcha.getResponse(this.instance)
      }
    }
    function recaptchaInitCallback () {
      window.gCaptcha = new Captcha('gRecaptcha', config.siteKey, send)
    }
    function send (token) {
      var elms = {
        'recaptcha_token': token,
        '_time': new Date().getTime()
      }
      $($('#form1_input_table :input:not([type=hidden])').serializeArray()).each(function (c, e) {
        e.name = e.name.replace("[]", "")
        // if (!elms[e.name]) {
        //   elms[e.name] = ''
        // }
        elms[e.name] = e.value
      })
      $.ajax(
        { 
          url: config.endpoint,
          type: "POST",
          contentType: "application/json",
          dataType: "json",
          data: JSON.stringify(elms)
        }
      ).then((data) => {
        console.log(data)
        $('#resposneBlock').show().text(JSON.stringify(data))
      }).catch((e) => {
        console.error(e)
        $('#resposneBlock').show().text(e.responseText)
      })
    }
    // Event Binding
    $('#sendButton').click(() => {
      window.gCaptcha.execute()
    })
  </script>
</body>

</html>